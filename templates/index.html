<!doctype html>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<title>Websockets tutorial</title>
<link rel=stylesheet type=text/css href="{{ url_for('static', filename='style.css') }}">
<div class=page>
    <h1>Hello World!</h1>
    <button onclick="json_button()">Json Message</button>
    <button onclick="alert_button()">Alert Message</button>
</div>
<script>
    var socket = io.connect('http://' + document.domain + ':' + location.port);
    var socket = io();
    // чё нажал клиент
    var movement = {
        up: false,
        down: false,
        left: false,
        right: false
    };
    // true - если клавиша нажата
    document.addEventListener('keydown', function (event) {
        switch (event.keyCode) {
            case 65: // A
                movement.left = true;
                break;
            case 87: // W
                movement.up = true;
                break;
            case 68: // D
                movement.right = true;
                break;
            case 83: // S
                movement.down = true;
                break;
        }
    });
    // false - если отжата
    document.addEventListener('keyup', function (event) {
        switch (event.keyCode) {
            case 65: // A
                movement.left = false;
                break;
            case 87: // W
                movement.up = false;
                break;
            case 68: // D
                movement.right = false;
                break;
            case 83: // S
                movement.down = false;
                break;
        }
    });
    socket.emit('new player');
    //setInterval(function () {
    //    socket.emit('movement', movement);
    //}, 1000 / 60);

    // тест
    socket.on('hi', function (data) {
        alert(data);
    });
</script>